<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      i18n:domain="eXtremeManagement">
  <metal:block use-macro="context/global_defines/macros/defines" />


  <body>
    <metal:block metal:define-macro="header">
       <h1 tal:content="here/title_or_id" class="documentFirstHeading">
          Title or id
       </h1>
       <div class="discreet" 
            tal:content="here/Description">Description
       </div>
       <link rel="stylesheet" type="text/css" href="eXtreme.css" />
    </metal:block>        
          
    <metal:block metal:define-macro="body"
         tal:define="iteration_path python:'/'.join(here.getPhysicalPath());
                     stories python:here.portal_catalog.searchResults(portal_type='Story',
                                                                      sort_on='Date',
                                                                      sort_order='traverse',
                                                                      path=iteration_path);">

        <tal:block tal:condition="stories">
          <h1 class="" i18n:translate="heading-stories">Stories</h1>
            <table class="listing"
                   width="100%%"
                   border="1"
                   cellpadding="0"
                   cellspacing="0">

              <tr tal:condition="stories">
                <th i18n:translate="listingheader_story">Story</th>
                <th i18n:translate="listingheader_state">Status</th>
                <th i18n:translate="listingheader_estimate">Estimates</th>
                <th i18n:translate="listingheader_actual">Actual</th>
              </tr>

              <tr tal:repeat="story stories">
                <div tal:define="storyObj story/getObject">
                  <td>
                    <a href=""
                       id="storyTitle_iteration_overview"
                       tal:attributes="href string:${storyObj/absolute_url}">
                      <span tal:content="storyObj/Title">Title</span></a>
                      <div class="story_description" 
                           tal:content="story/Description">Description</div>
                  </td>

                  <td tal:define="wtool here/portal_workflow;
                                  review_state python:wtool.getInfoFor(storyObj, 'review_state')"
                      tal:content="review_state" i18n:translate="">Status</td>
                  <td id="td-estimate" 
                      tal:content="python:here.getTotalEstimate(storyObj)">Estimate</td>
                  <td id="td-actual" 
                      tal:content="python:here.getTotalActual(storyObj)">Actual</td>
                </div>
              </tr>
              <tr>
                <td id="total" 
                    colspan="2" 
                    i18n:translate="total">Total</td>
                <td id="total-estimate"
                    tal:define="totalEstimate python:here.getTotalEstimate();"
                    tal:content="totalEstimate">Total estimate</td>
                <td id="total-actual"
                    tal:define="totalActual python:here.getTotalActual();"
                    tal:content="totalActual">Total actual</td>
              </tr>
            </table>
        </tal:block>

        <p class="discreet" 
           tal:condition="python: not stories"
           i18n:translate="no_stories_published">No stories published yet!</p>

    </metal:block>
    <metal:block metal:define-macro="folderlisting" />
  </body>
</html>
