<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en"
      lang="en"
      i18n:domain="rXtremeManagement"
      metal:use-macro="here/main_template/macros/master">

  <head>
      <metal:block fill-slot="top_slot">
        <span tal:replace="nothing"
              tal:define="dummy python:request.set('enable_border', 1)" />
      </metal:block>
  </head>

  <body>

    <div metal:fill-slot="main"
         tal:define="totalActual python:here.getTotalActual();
                     totalEstimate python:here.getTotalEstimate()">

        <h1 tal:content="here/title_or_id" class="documentFirstHeading">
          Title or id
        </h1>

        <div class="documentDescription" 
             tal:condition="here/Description" 
             tal:content="here/Description">description
        </div>

        <div class="stx" tal:replace="structure here/CookedBody">
            body text
        </div>


        <tal:block tal:condition="python:here.contentValues('Task')">
          <h1 class="" i18n:translate="heading-tasks">Tasks</h1>
          <table class="listing"
                 border="1"
                 cellpadding="0" cellspacing="0">

             <thead>
               <tr>
                 <th i18n:translate="listingheader_desc">Description</th>
                 <th i18n:translate="listingheader_estimate">Estimate</th>                  
                 <th i18n:translate="listingheader_actual">Actual</th>
                 <th i18n:translate="listingheader_diff">Difference</th>
                 <th i18n:translate="listingheader_state">Status</th>
                 <th i18n:translate="listingheader_assignee">Assignee(s)</th>
               </tr>
             </thead>

               <tr tal:define="items python:here.contentValues('Task')"
                   tal:repeat="item items">
                 <td>
                   <a href=""
                      tal:attributes="href string:${item/absolute_url}">
                      <span tal:content="item/task">Task</span></a></td>
                 <td id="td-estimate" tal:content="item/estimate">Estimate</td>
                 <td id="td-actual" tal:content="item/actual">Actual</td>
                 <td id="td-diff" tal:content="python: item.estimate - item.actual">Difference</td>
                 <td tal:define="wtool here/portal_workflow;
                                 review_state python:wtool.getInfoFor(item, 'review_state')"
                     tal:content="review_state">Status</td>
                 <td tal:content="item/assignee">Assignee</td>
               </tr>
               
               <tr class="totalTasks">
                 <td id="total" i18n:translate="total">Total</td>
                 <td id="total-estimate"
                     tal:content="totalEstimate">total estimate</td>
                 <td id="total-actual" 
                     tal:content="totalActual">total actual</td>
                 <td id="total-diff" 
                     tal:content="python: totalEstimate - totalActual">total diff</td>
                 <td>&nbsp;</td>  
                 <td>&nbsp;</td>  
               </tr>

          </table>
        </tal:block>
    
        <div class="discreet"
             tal:condition="python: not here.contentValues('Task')"
             i18n:translate="no_tasks_defined">No tasks defined yet.</div>

    </div>
  </body>
</html>
