<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      i18n:domain="eXtremeManagement">
    <metal:block use-macro="context/global_defines/macros/defines" />
    <metal:block metal:use-macro="header" />
    
    <body>
    <metal:block metal:define-macro="body"
                 tal:define="path python:'/'.join(context.aq_parent.getPhysicalPath());
                             filter python:{'query': path, 'depth': 1};
                             tasks python:context.portal_catalog({'path': filter});
                             num_tasks python:len(tasks);
                             pos context/getObjPositionInParent;
                             next python:pos &lt; num_tasks-1 and tasks[pos+1];
                             prev python:pos != 0 and tasks[pos-1];">

      <div class="listingBar">
        <a class="listingNext"
           tal:condition="python:next"
           tal:attributes="href next/getURL"
           tabindex="1"
           href="">
          <span i18n:translate="next">
            Next: </span>
          <span tal:replace="next/Title" />
          <img tal:replace="structure here/arrowRight.gif" />
        </a>
        <a class="listingPrevious"
           tal:condition="python:prev"
           tal:attributes="href prev/getURL"
           tabindex="1"
           href="">
          <img tal:replace="structure here/arrowLeft.gif" />
          <span i18n:translate="previous">
            Previous: </span>
          <span tal:replace="prev/Title" />
        </a>
          &nbsp;
      </div>
        <div class="documentDescription"
             tal:condition="here/Description"
             tal:content="here/Description">
            description
        </div>
        <div tal:replace="structure context/CookedBody" />
        <table class="listing"
                border="1" 
                width="100%"
                cellpadding="0" 
                cellspacing="0">
            <tr>
                <th class="customer_info_header" 
                    i18n:translate="listingheader_estimate">
                    Estimate
                </th>
                <td tal:content="here/getEstimate" />
            </tr>
            <tr>
                <th class="customer_info_header" 
                    i18n:translate="listingheader_actual">
                    Actual
                </th>
                <td tal:content="here/getActualHours">
                    0:00
                </td>
            </tr>
            <tr>
                <th class="customer_info_header"
                    i18n:translate="listingheader_state">
                    Status
                </th>
                <td tal:define="wtool here/portal_workflow;
                                review_state python:wtool.getInfoFor(here, 'review_state')"
                    tal:content="review_state" />
            </tr>
            <tr>
                <th class="customer_info_header"
                    i18n:translate="listingheader_assignees">
                    Assignee(s)
                </th>
                <td>
                    <tal:block
                          tal:repeat="item here/getAssignees">
                        <img tal:replace="structure context/user.gif" />
                        <span tal:replace="item">Assignee</span>
                        <br />
                    </tal:block>
                </td>
            </tr>
        </table>

        <tal:block tal:define="bookings context/getSortedBookings"
                   tal:condition="bookings">
            <h1 i18n:translate="heading-bookings">Bookings</h1>
            
            <table border="1" 
                   class="listing" 
                   with="100%">
                <tr>
                    <th i18n:translate="listingheader-bookingdate">
                        Date
                    </th>
                    <th i18n:translate="listingheader-booking">
                        Booking
                    </th>
                    <th i18n:translate="listingheader-time">
                        Time
                    </th>
                    <th i18n:translate="listingheader-booked-by">
                        Booked by
                    </th>
                    <th i18n:translate="listingheader-billable">
                        Billable
                    </th>
                </tr>
            
                <tr tal:repeat="booking bookings">
                    <td tal:content="booking/getBookingDate">
                        2006-01-01
                    </td>
                    <td>
                        <a tal:attributes="href string:${booking/absolute_url}/base_edit"
                           class="booking_title"
                           tal:content="booking/Title" />
                        <div class="booking_description" 
                             tal:content="booking/Description" />
                    </td>
                    <td tal:content="booking/getActualHours" />
                    <td tal:content="booking/Creator" />
                    <td tal:content="booking/getBillable" />
                </tr>
            </table>
        </tal:block>

    </metal:block>
    <metal:block metal:define-macro="folderlisting" />
    </body>
</html>

