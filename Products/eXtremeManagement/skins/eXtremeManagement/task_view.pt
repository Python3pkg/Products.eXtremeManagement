<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="eXtremeManagement">

  <body>
  <div metal:fill-slot="main">
    <div metal:define-macro="body"
         tal:define="view context/@@task;
                     task view/main;
                     tasks python:context.aq_parent.getFolderContents();
                     num_tasks python:len(tasks);
                     pos context/getObjPositionInParent;
                     next python:pos &lt; num_tasks-1 and tasks[pos+1];
                     prev python:pos != 0 and tasks[pos-1];
                     startable context/startable">

      <metal:prevnext use-macro="context/story_view/macros/previous_next" />

      <div class="xm-details">
        <dl tal:condition="not:startable" class="not-startable">
          <dt i18n:translate="cannot_activate">Cannot Activate</dt>
          <dd tal:condition="python:len(context.getAssignees()) == 0">No one has been assigned to this task.</dd>
          <dd tal:condition="python:context.getHours() == 0 and context.getMinutes() == 0">Need to assign a time estimate to this task.</dd>

        </dl>

        <table class="listing"
                width="100%"
                cellpadding="0"
                cellspacing="0">
            <tr>
                <th class="customer_info_header"
                    i18n:translate="listingheader_estimate_hours">
                    Estimate (hours)
                </th>
                <td tal:content="task/estimate" />
            </tr>
            <tr>
                <th class="customer_info_header"
                    i18n:translate="listingheader_actual_hours">
                    Actual (hours)
                </th>
                <td tal:content="task/actual">
                    0:00
                </td>
            </tr>
            <tr>
                <th class="customer_info_header"
                    i18n:translate="listingheader_state">
                    Status
                </th>
                <td tal:content="task/review_state" />
            </tr>
            <tr>
                <th class="customer_info_header"
                    i18n:translate="listingheader_assignees">
                    Assignee(s)
                </th>
                <td>
                    <ul class="xm-assignees">
                        <li tal:repeat="item task/assignees"><span tal:replace="item/niceName">Assignee</span></li>
                    </ul>
                </td>
            </tr>
        </table>

        <div class="visualClear"><!-- --></div>
      </div>

      <p class="documentDescription">
        <metal:field use-macro="python:here.widget('description', mode='view')">
          Description
        </metal:field>
      </p>

      <metal:field use-macro="python:here.widget('mainText', mode='view')">
        Body text
      </metal:field>


        <div id="break-before-bookings" class="visualClear"><!-- --></div>

        <tal:block tal:define="bookings view/bookings"
                   tal:condition="bookings">
            <h2 i18n:translate="heading-bookings">Time Bookings</h2>

            <table border="1"
                   class="listing xm-bookings"
                   with="100%">
                <tr>
                    <th i18n:translate="listingheader-bookingdate">
                        Date
                    </th>
                    <th i18n:translate="listingheader-booking">
                        Booking
                    </th>
                    <th i18n:translate="listingheader-time">
                        Time
                    </th>
                    <th i18n:translate="listingheader-booked-by">
                        Booked by
                    </th>
                    <th i18n:translate="listingheader-billable">
                        Billable
                    </th>
                </tr>

                <tr tal:repeat="booking bookings">
                    <td tal:content="booking/date">
                        2006-01-01
                    </td>
                    <td>
                        <a tal:attributes="href string:${booking/url}"
                           class="booking_title"
                           tal:content="booking/title" />
                        <div class="booking_description"
                             tal:content="booking/description" />
                    </td>
                    <td tal:content="booking/actual" />
                    <td>
                        <img tal:replace="structure context/user.gif" />
                        <span tal:replace="python:context.poi_niceName(booking['creator'])">Assignee</span>
                    </td>
                    <td tal:content="booking/billable" />
                </tr>
            </table>
        </tal:block>

    </div>
    <metal:block metal:define-macro="folderlisting" />
  </div>
  </body>
</html>
