<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en-US"
      lang="en-US"
      metal:use-macro="here/main_template/macros/master"
      i18n:domain="eXtremeManagement">

  <body>

    <div metal:fill-slot="main">
      <div metal:define-macro="body"
           tal:define="view context/@@iteration;
                       iteration view/main;
                       iteration_number string:1;
                       stories view/stories;
                       start context/getStartDate;
                       end context/getEndDate;">

        <div class="xm-details"
             tal:condition="python: start or end">

          <table class="listing"
                 width="100%"
                 cellpadding="0"
                 cellspacing="0">
            <tr tal:condition="start">
              <th class="customer_info_header"
                  i18n:translate="estimated_start_project">Estimated start of project</th>
              <td>
                <metal:field use-macro="python:here.widget('startDate',
                                        mode='view')">
                  Variable goes here
                </metal:field>
              </td>
            </tr>
            <tr tal:condition="end">
              <th class="customer_info_header"
                  i18n:translate="estimated_release_date">Estimated release date</th>
              <td>
                <metal:field use-macro="python:here.widget('endDate',
                                        mode='view')">
                  Variable goes here
                </metal:field>
              </td>
            </tr>

          </table>

          <div class="visualClear"><!-- --></div>
        </div>

        <p class="documentDescription">
          <metal:field use-macro="python:here.widget('description', mode='view')">
            Description
          </metal:field>
        </p>


        <div id="break-before-stories" class="visualClear"><!-- --></div>

        <tal:subitems tal:condition="stories">
          <table width="100%"
                 cellpadding="0"
                 cellspacing="0">
            <tr>
              <th class="offer-story-title-header"
                  i18n:translate="heading-stories">Stories</th>
              <th class="offer-story-estimate-header"
                  i18n:translate="listingheader_initial_estimate">
                Initial estimate (days)
              </th>
            </tr>

            <tal:repeat repeat="story stories">
              <tr>
                <td>
                  <span class="offer-story-title" tal:content="story/title" /><br />
                  <span class="offer-story-main"
                        tal:define="storyid story/story_id;
                                    story_obj python:context[storyid]"
                        tal:content="structure story_obj/getMainText" />
                </td>
                <td class="offer-story-estimate" tal:content="story/size_estimate" />
              </tr>
            </tal:repeat>

            <tr id="totalTasks">
              <th class="offer-story-title-footer"
                  i18n:translate="total">Total</th>
              <th class="offer-story-estimate-footer"
                  tal:content="iteration/size_estimate" />
            </tr>
          </table>
        </tal:subitems>

        <p class="discreet"
           tal:condition="python: not stories"
           i18n:translate="no_stories_published">
          No stories published yet!
        </p>
      </div>

      <metal:block metal:define-macro="folderlisting" />
    </div>
  </body>
</html>
